(self.webpackChunkant_design_pro=self.webpackChunkant_design_pro||[]).push([[667],{13745:function(H,B,e){"use strict";e.r(B),e.d(B,{default:function(){return X}});var T=e(62350),x=e(75443),p=e(57663),D=e(71577),R=e(86582),V=e(34792),O=e(48086),b=e(3182),U=e(69610),L=e(54941),Z=e(81306),K=e(72936),Y=e(402),F=e(97272),$=e(94043),n=e.n($),t=e(67294),i=e(95357),a=e(8212),_=e(73171),o=e(26303),r=e(78009),w=e(57895),v=e(11021),j=e(90672),z=e(26743),S=e(37476),N=e(5966),J=e(49101),u=e(85893),Q=F.Z.Title,X=function(k){(0,Z.Z)(W,k);var G=(0,K.Z)(W);function W(){var E;(0,U.Z)(this,W);for(var P=arguments.length,y=new Array(P),C=0;C<P;C++)y[C]=arguments[C];return E=G.call.apply(G,[this].concat(y)),E.state={topics:[],file:""},E.formRef=t.createRef(),E.getTopics=(0,b.Z)(n().mark(function h(){var d,l;return n().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return d=1,c.next=3,(0,v.D0)(d);case 3:l=c.sent,console.log(l),l.error_code==200&&E.setState({topics:l.data.map(function(f){var s=f.fields;return s.topic_id=f.pk,s.topic_img&&(s.topic_img={url:"/media/"+s.topic_img,name:s.topic_img}),s})});case 6:case"end":return c.stop()}},h)})),E.addNewTopic=function(){var h=(0,b.Z)(n().mark(function d(l){var m,c,f,s;return n().wrap(function(M){for(;;)switch(M.prev=M.next){case 0:if(console.log(l),m=1,!(!l.topic_content||!l.topic_title)){M.next=5;break}return O.default.error("please input the topic_title and the topic_content"),M.abrupt("return",!1);case 5:return M.next=7,(0,v.rq)(l.topic_title,l.topic_content,E.state.file,m);case 7:if(c=M.sent,c.error_code!=200){M.next=16;break}return s={topic_id:c.id,topic_title:l.topic_title,topic_content:l.topic_content,topic_img:E.state.file},E.setState({topics:[].concat((0,R.Z)(E.state.topics),[s])}),O.default.success("topic has been created successfully"),(f=E.formRef.current)===null||f===void 0||f.resetFields(),M.abrupt("return",!0);case 16:return O.default.error(c.msg),M.abrupt("return",!1);case 18:case"end":return M.stop()}},d)}));return function(d){return h.apply(this,arguments)}}(),E.confirm=function(){var h=(0,b.Z)(n().mark(function d(l){var m;return n().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:return f.next=2,(0,v.BK)(l);case 2:m=f.sent,m.error_code==200?(O.default.success("Delete success."),E.getTopics()):O.default.success("Fail to delete. Please try again later");case 4:case"end":return f.stop()}},d)}));return function(d){return h.apply(this,arguments)}}(),E.handleChange=function(){var h=(0,b.Z)(n().mark(function d(l){var m,c;return n().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:if(console.log(l),m=l.file,!(m&&m.status=="done"&&m.response)){s.next=6;break}m.name=m.response.imgUrl,s.next=12;break;case 6:if(m.status!="removed"){s.next=12;break}return s.next=9,(0,v.EI)(m.name,"Topic");case 9:c=s.sent,console.log(c),m=void 0;case 12:E.setState({file:m});case 13:case"end":return s.stop()}},d)}));return function(d){return h.apply(this,arguments)}}(),E}return(0,L.Z)(W,[{key:"componentDidMount",value:function(){this.getTopics()}},{key:"render",value:function(){var P=this,y=function(h){var d=h.icon,l=h.text;return(0,u.jsxs)("span",{children:[t.createElement(d,{style:{marginRight:8}}),l]})};return(0,u.jsx)("div",{style:{background:"#F5F7FA"},children:(0,u.jsx)(r.ZP,{header:{title:(0,u.jsx)(Q,{level:2,children:"Course Management"}),ghost:!0,breadcrumb:{}},children:(0,u.jsx)(w.ZP,{children:(0,u.jsx)(o.Z,{toolBarRender:function(){return[(0,u.jsxs)(S.Y,{title:"Add a new topic",trigger:(0,u.jsxs)(D.Z,{type:"primary",children:[(0,u.jsx)(J.Z,{}),"NEW"]}),formRef:P.formRef,autoFocusFirstInput:!0,onFinish:function(d){return P.addNewTopic(d)},submitter:{searchConfig:{submitText:"submit",resetText:"cancel"}},children:[(0,u.jsx)(N.Z,{width:"md",name:"topic_title",label:"Topic Title",placeholder:"please input a topic title"}),(0,u.jsx)(j.Z,{name:"topic_content",label:"topic description",placeholder:"please input topic description",width:"xl"}),(0,u.jsx)(z.Z,{name:"topic_img",label:"Upload",max:1,beforeUpload:P.handleBeforeUpload,fieldProps:{name:"topic_img",listType:"picture-card",accept:".jpg, .png, .jpeg, .gif"},action:"/server/V1/course/upload_topic_img/",onChange:P.handleChange})]})]},itemLayout:"vertical",rowKey:"topic_id",headerTitle:"Topics",dataSource:this.state.topics,metas:{title:{dataIndex:"topic_title",render:function(h){return(0,u.jsx)("a",{href:"/courseAdmin/courseList?topic_title=".concat(h),style:{textDecoration:"none",color:"#333"},children:h})}},actions:{render:function(h,d){return[(0,u.jsx)("a",{href:"/courseAdmin/courseList?topic_title=".concat(d.topic_title),children:(0,u.jsx)(y,{icon:i.Z,text:"view"},"list-vertical-message")}),(0,u.jsxs)(S.Y,{title:"EDIT",initialValues:d,trigger:(0,u.jsx)("a",{children:(0,u.jsx)(y,{icon:a.Z,text:"edit"},"list-vertical-star-o")}),autoFocusFirstInput:!0,onFinish:function(){var l=(0,b.Z)(n().mark(function m(c){var f;return n().wrap(function(g){for(;;)switch(g.prev=g.next){case 0:if(console.log(c),!(!c.topic_content&&!c.topic_title&&!c.topic_img)){g.next=6;break}return O.default.info("Nothing changed"),g.abrupt("return",!0);case 6:return c.topic_img&&(c.topic_img=c.topic_img[0]),g.next=9,(0,v.wA)(d.topic_id,c);case 9:if(f=g.sent,f.error_code!=200){g.next=16;break}return P.getTopics(),O.default.success("topic infomation changed success"),g.abrupt("return",!0);case 16:return O.default.error(f.msg),g.abrupt("return",!1);case 18:case"end":return g.stop()}},m)}));return function(m){return l.apply(this,arguments)}}(),submitter:{searchConfig:{submitText:"submit",resetText:"cancel"}},children:[(0,u.jsx)(N.Z,{width:"md",name:"topic_title",label:"Topic Title",placeholder:"please input a topic title"}),(0,u.jsx)(j.Z,{name:"topic_content",label:"topic description",placeholder:"please input topic description"}),(0,u.jsx)(z.Z,{name:"topic_img",beforeUpload:P.handleBeforeUpload,fieldProps:{name:"topic_img",listType:"picture-card",accept:".jpg, .png, .jpeg, .gif"},action:"/server/V1/course/upload_topic_img/",onChange:function(){var l=(0,b.Z)(n().mark(function m(c){var f,s,g;return n().wrap(function(I){for(;;)switch(I.prev=I.next){case 0:if(console.log(c),f=P.state.topics,s=c.file,s.status!="removed"){I.next=8;break}return I.next=6,(0,v.EI)(s.name,"Topic");case 6:g=I.sent,console.log(g);case 8:f.map(function(A){return A.topic_id==d.topic_id&&(s.status=="removed"?A.topic_img="":(s&&s.status=="done"&&s.response&&(s.name=s.response.imgUrl),A.topic_img=s)),A}),P.setState({topics:f});case 10:case"end":return I.stop()}},m)}));return function(m){return l.apply(this,arguments)}}(),label:"Upload",max:1,value:d.topic_img?[d.topic_img]:[]})]}),(0,u.jsx)(x.Z,{title:"Are you sure to delete this topic? This action will also delets all courses attached to this topic",onConfirm:function(){return P.confirm(d.topic_id)},okText:"Yes",cancelText:"No",children:(0,u.jsx)("a",{children:(0,u.jsx)(y,{icon:_.Z,text:"delete"},"list-vertical-like-o")})})]}},extra:{dataIndex:"topic_img",render:function(h){if(h)return(0,u.jsx)("img",{width:"180px",alt:"logo",src:"".concat(h.url)})}},content:{dataIndex:"topic_content",render:function(h){return(0,u.jsx)("div",{children:h})}}}})})})})}}]),W}(t.Component)},11021:function(H,B,e){"use strict";e.d(B,{D0:function(){return R},wA:function(){return V},tu:function(){return O},rq:function(){return b},xH:function(){return U},G$:function(){return L},Sp:function(){return Z},A:function(){return K},BK:function(){return Y},BW:function(){return F},EI:function(){return $}});var T=e(3182),x=e(94043),p=e.n(x),D=e(21010),R=function(){var n=(0,T.Z)(p().mark(function t(i){var a;return p().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return a="/server/V1/course/topicsByTeacher/?teacher_id=".concat(i),o.abrupt("return",(0,D.WY)(a));case 2:case"end":return o.stop()}},t)}));return function(i){return n.apply(this,arguments)}}(),V=function(){var n=(0,T.Z)(p().mark(function t(i,a){var _;return p().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return _="/server/V1/course/edit/",r.abrupt("return",(0,D.WY)(_,{method:"post",data:{request_entity:"Topic",content:{topic_id:i,topic_info:a}}}));case 2:case"end":return r.stop()}},t)}));return function(i,a){return n.apply(this,arguments)}}(),O=function(){var n=(0,T.Z)(p().mark(function t(i,a,_,o,r){var w;return p().wrap(function(j){for(;;)switch(j.prev=j.next){case 0:return w="/server/V1/course/edit/",j.abrupt("return",(0,D.WY)(w,{method:"post",data:{request_entity:"Course",content:{id:i,related_topic:a,title:_,content:o,teacher_id:r}}}));case 2:case"end":return j.stop()}},t)}));return function(i,a,_,o,r){return n.apply(this,arguments)}}(),b=function(){var n=(0,T.Z)(p().mark(function t(i,a,_,o){var r;return p().wrap(function(v){for(;;)switch(v.prev=v.next){case 0:return r="/server/V1/course/create/",v.abrupt("return",(0,D.WY)(r,{method:"post",data:{request_entity:"Topic",content:{topic_title:i,topic_content:a,topic_img:_,teacher_id:o}}}));case 2:case"end":return v.stop()}},t)}));return function(i,a,_,o){return n.apply(this,arguments)}}(),U=function(){var n=(0,T.Z)(p().mark(function t(i,a,_,o){var r;return p().wrap(function(v){for(;;)switch(v.prev=v.next){case 0:return r="/server/V1/course/create/",v.abrupt("return",(0,D.WY)(r,{method:"post",data:{request_entity:"Course",content:{related_topic:i,title:a,content:_,teacher_id:o}}}));case 2:case"end":return v.stop()}},t)}));return function(i,a,_,o){return n.apply(this,arguments)}}(),L=function(){var n=(0,T.Z)(p().mark(function t(i){var a;return p().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return a="/server/V1/course/courses/".concat(i,"/"),o.abrupt("return",(0,D.WY)(a));case 2:case"end":return o.stop()}},t)}));return function(i){return n.apply(this,arguments)}}(),Z=function(){var n=(0,T.Z)(p().mark(function t(i,a){var _;return p().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return _="/server/V1/course/courseDetail/".concat(i,"/").concat(a,"/"),r.abrupt("return",(0,D.WY)(_));case 2:case"end":return r.stop()}},t)}));return function(i,a){return n.apply(this,arguments)}}(),K=function(){var n=(0,T.Z)(p().mark(function t(i,a){var _;return p().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return _="/server/V1/course/delete/",r.abrupt("return",(0,D.WY)(_,{method:"post",data:{request_entity:"Course",related_topic:i,content:a}}));case 2:case"end":return r.stop()}},t)}));return function(i,a){return n.apply(this,arguments)}}(),Y=function(){var n=(0,T.Z)(p().mark(function t(i){var a;return p().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return a="/server/V1/course/delete/",o.abrupt("return",(0,D.WY)(a,{method:"post",data:{request_entity:"Topic",content:i}}));case 2:case"end":return o.stop()}},t)}));return function(i){return n.apply(this,arguments)}}(),F=function(){var n=(0,T.Z)(p().mark(function t(i,a){var _;return p().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return _="/server/V1/course/sort/",r.abrupt("return",(0,D.WY)(_,{method:"post",data:{request_entity:"Course",related_topic:i,content:a}}));case 2:case"end":return r.stop()}},t)}));return function(i,a){return n.apply(this,arguments)}}(),$=function(){var n=(0,T.Z)(p().mark(function t(i,a){var _;return p().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return _="/server/V1/course/delete_img/",r.abrupt("return",(0,D.WY)(_,{method:"post",data:{request_entity:a,fname:i}}));case 2:case"end":return r.stop()}},t)}));return function(i,a){return n.apply(this,arguments)}}()}}]);
