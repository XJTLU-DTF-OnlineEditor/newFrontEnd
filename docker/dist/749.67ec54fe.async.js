(self.webpackChunkant_design_pro=self.webpackChunkant_design_pro||[]).push([[749],{97749:function(q,I,e){"use strict";e.r(I),e.d(I,{default:function(){return de}});var E=e(58024),b=e(39144),l=e(13062),h=e(71230),J=e(13254),P=e(14277),Q=e(34792),A=e(48086),$=e(3182),Y=e(69610),K=e(54941),H=e(3372),z=e(81306),N=e(72936),X=e(402),c=e(72031),i=e(94043),t=e.n(i),r=e(67294),o=e(49101),a=e(21010),s=e(11021),D=e(29811),O=e(79752),g=e(1798),k=e.n(g),C=e(45587),U=e(11849),fe=e(20136),_=e(55241),pe=e(57663),ee=e(71577),ve=e(49111),G=e(19650),te=e(2824),re=e(24285),ne=e(42762),ae=e(95357),se=e(8212),ie=e(40376),oe=e(73171),n=e(85893),ue=c.Z.Text,he=c.Z.Link;function ce(m){var V=(0,r.useState)(!1),W=(0,te.Z)(V,2),u=W[0],w=W[1],T=(0,C.nB)({id:m.id}),F=T.attributes,y=T.listeners,f=T.setNodeRef,v=T.transform,p=T.transition,x={transform:re.ux.Transform.toString(v),transition:p,cursor:"grab",margin:"10px"},Z=["#7193f1","#ffda6c","#00bcd4","#ef769f"],d=["#7193f122","#ffda6c22","#00bcd422","#ef769f22"],M=function(L){var R=L.icon,j=L.text;return(0,n.jsxs)("span",{children:[r.createElement(R,{style:{marginRight:8}}),j]})};return(0,n.jsx)(n.Fragment,{children:(0,n.jsx)("div",(0,U.Z)((0,U.Z)((0,U.Z)({ref:f,style:x},F),y),{},{onMouseEnter:function(){w(!0)},onMouseLeave:function(){w(!1)},children:(0,n.jsxs)(b.Z,{bordered:!1,className:"item",style:{borderLeft:"3px solid ".concat(Z[(m.topic_info.topic_id-1)%4]),backgroundColor:u?"".concat(d[(m.topic_info.topic_id-1)%4]):"white"},children:[(0,n.jsxs)(G.Z,{children:[(0,n.jsx)(ne.Z,{style:{cursor:"grab",color:"".concat(Z[(m.topic_info.topic_id-1)%4])}}),"\xA0",(0,n.jsx)(ue,{style:{color:Z[(m.topic_id-1)%4]},children:m.id}),m.item.title,"\xA0"]}),(0,n.jsxs)(G.Z,{style:{float:"right",display:u?"inline-flex":"none"},children:[(0,n.jsx)("a",{href:"/courseAdmin/courseManager?topic_title="+m.topic_info.topic_title+"&id="+m.id,children:(0,n.jsxs)("span",{children:[r.createElement(ae.Z,{style:{marginRight:8}}),(0,n.jsx)(a._H,{id:"pages.common.view"})]})}),(0,n.jsx)("a",{href:"/courseAdmin/courseManager?topic_title="+m.topic_info.topic_title+"&id="+m.id,children:(0,n.jsxs)("span",{children:[r.createElement(se.Z,{style:{marginRight:8}}),(0,n.jsx)(a._H,{id:"pages.common.edit"})]})}),(0,n.jsx)(_.Z,{content:(0,n.jsxs)("div",{children:[(0,n.jsx)(h.Z,{children:(0,n.jsxs)("span",{children:[(0,n.jsx)(ie.Z,{twoToneColor:"#faad14",style:{marginRight:8}}),(0,n.jsx)(a._H,{id:"pages.des.del"})]})}),(0,n.jsx)(h.Z,{justify:"end",children:(0,n.jsx)(G.Z,{children:(0,n.jsx)(ee.Z,{type:"primary",size:"small",onMouseUp:(0,$.Z)(t().mark(function S(){var L;return t().wrap(function(j){for(;;)switch(j.prev=j.next){case 0:return j.next=2,(0,s.A)(m.topic_info.topic_title,[m.id]);case 2:L=j.sent,L.error_code==200?(A.default.success("Delete success"),PubSub.publish("update",!0)):A.default.error("Delete error");case 4:case"end":return j.stop()}},S)})),children:(0,n.jsx)(a._H,{id:"pages.common.yes"})})})})]}),children:(0,n.jsx)("a",{children:(0,n.jsxs)("span",{children:[r.createElement(oe.Z,{style:{marginRight:8}}),(0,n.jsx)(a._H,{id:"pages.common.delete"})]})})})]})]})}))})}var le=c.Z.Title,de=function(m){(0,z.Z)(W,m);var V=(0,N.Z)(W);function W(){var u;(0,Y.Z)(this,W);for(var w=arguments.length,T=new Array(w),F=0;F<w;F++)T[F]=arguments[F];return u=V.call.apply(V,[this].concat(T)),u.state={selectedRowKeys:[],dataSource:[]},u.teacher_info=r.createRef(),u.color=["#7193f1","#ffda6c","#00bcd4","#ef769f"],u.overColor=["#F6F8FE","#FFFDF5","#EEFBFC","#FEF6F9"],u.handleDragEnd=function(y){var f=y.active,v=y.over,p=u.state.dataSource;if(f.id!==v.id){var x=p.map(function(d){return d.id}).indexOf(f.id),Z=p.map(function(d){return d.id}).indexOf(v.id);console.log(x,Z,444),p=(0,C.Rp)(p,x,Z),u.setState({dataSource:p}),u.handleDragSortEnd(p)}},u.getDataSource=(0,$.Z)(t().mark(function y(){var f,v,p,x;return t().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return d.next=2,(0,D.ar)();case 2:return f=d.sent,u.teacher_info.current=f.data,v=u.props.topic_info.topic_title,d.next=7,(0,a.WY)("/server/V1/course/courses/".concat(v,"/"));case 7:p=d.sent,p.error_code==200?(x=p.course_list.map(function(M){var S=M.fields;return S.id=M.pk,S}),x.forEach(function(M){M.update_date=new Date(M.update_date)}),u.setState({dataSource:x})):u.setState({dataSource:null});case 9:case"end":return d.stop()}},y)})),u.handleDragSortEnd=function(){var y=(0,$.Z)(t().mark(function f(v){var p,x,Z,d,M,S;return t().wrap(function(R){for(;;)switch(R.prev=R.next){case 0:return console.log("\u6392\u5E8F\u540E\u7684\u6570\u636E",v),p=u.props.topic_info.topic_title,x=u.state.dataSource,Z=x.map(function(j,B){return{id:j.id,subtopic_id:B+1}}),d=v.map(function(j,B){return{id:j.id,subtopic_id:B+1}}),M=d.filter(function(j,B){return j.id!=Z[B].id}),R.next=8,(0,s.BW)(p,M);case 8:S=R.sent,S.error_code==200?(u.setState({dataSource:v}),A.default.success("Modified course order successfully")):A.default.error("Failed to modify course order! ",S.msg);case 10:case"end":return R.stop()}},f)}));return function(f){return y.apply(this,arguments)}}(),u.handleDelete=(0,$.Z)(t().mark(function y(){var f,v,p,x;return t().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return f=(0,H.Z)(u),v=f.table,p=u.state.selectedRowKeys,d.next=4,(0,s.A)(u.props.topic_info.topic_title,p);case 4:x=d.sent,x.error_code==200?A.default.success("Delete success"):A.default.error("Delete error"),v.reload();case 7:case"end":return d.stop()}},y)})),u}return(0,K.Z)(W,[{key:"componentDidMount",value:function(){var w=this;this.getDataSource(),k().subscribe("update",function(T,F){w.getDataSource()})}},{key:"render",value:function(){var w=this,T=function(v){w.setState({selectedRowKeys:v})},F=this.state.dataSource,y=this.props.topic_info;return console.log(),(0,n.jsxs)(n.Fragment,{children:[F?(0,n.jsx)(O.LB,{collisionDetection:O.pE,onDragEnd:this.handleDragEnd,children:(0,n.jsx)(C.Fo,{items:this.state.dataSource,strategy:C.qw,children:this.state.dataSource.map(function(f){return(0,n.jsx)(ce,{item:f,id:f.id,topic_info:y},f.id)})})}):(0,n.jsx)(P.Z,{image:P.Z.PRESENTED_IMAGE_SIMPLE,description:(0,n.jsx)(a._H,{id:"pages.common.des.empty"})}),(0,n.jsx)(b.Z,{className:"item",bordered:!1,style:{backgroundColor:"".concat(this.overColor[(y.topic_id-1)%4]),cursor:"pointer",margin:"10px"},onClick:function(){window.location.href="/courseAdmin/courseManager?topic_title="+y.topic_title},children:(0,n.jsx)(h.Z,{justify:"center",children:(0,n.jsxs)(le,{level:5,style:{color:"grey",fontWeight:"normal"},children:[(0,n.jsx)(o.Z,{}),"\xA0",(0,n.jsx)(a._H,{id:"pages.courseList.newCourse"})]})})})]})}}]),W}(r.Component)},11021:function(q,I,e){"use strict";e.d(I,{D0:function(){return J},wA:function(){return P},tu:function(){return Q},rq:function(){return A},xH:function(){return $},G$:function(){return Y},Sp:function(){return K},A:function(){return H},BK:function(){return z},BW:function(){return N},EI:function(){return X}});var E=e(3182),b=e(94043),l=e.n(b),h=e(21010),J=function(){var c=(0,E.Z)(l().mark(function i(t){var r;return l().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return r="/server/V1/course/topicsByTeacher/?teacher_id=".concat(t),a.abrupt("return",(0,h.WY)(r));case 2:case"end":return a.stop()}},i)}));return function(t){return c.apply(this,arguments)}}(),P=function(){var c=(0,E.Z)(l().mark(function i(t,r){var o;return l().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return o="/server/V1/course/edit/",s.abrupt("return",(0,h.WY)(o,{method:"post",data:{request_entity:"Topic",content:{topic_id:t,topic_info:r}}}));case 2:case"end":return s.stop()}},i)}));return function(t,r){return c.apply(this,arguments)}}(),Q=function(){var c=(0,E.Z)(l().mark(function i(t,r,o,a,s,D,O){var g;return l().wrap(function(C){for(;;)switch(C.prev=C.next){case 0:return g="/server/V1/course/edit/",C.abrupt("return",(0,h.WY)(g,{method:"post",data:{request_entity:"Course",content:{id:t,related_topic:r,title:o,content:a,answer:s,hint:D,teacher_id:O}}}));case 2:case"end":return C.stop()}},i)}));return function(t,r,o,a,s,D,O){return c.apply(this,arguments)}}(),A=function(){var c=(0,E.Z)(l().mark(function i(t,r,o,a,s){var D;return l().wrap(function(g){for(;;)switch(g.prev=g.next){case 0:return D="/server/V1/course/create/",g.abrupt("return",(0,h.WY)(D,{method:"post",data:{request_entity:"Topic",content:{topic_title:t,topic_content:r,topic_description:o,topic_img:a,teacher_id:s}}}));case 2:case"end":return g.stop()}},i)}));return function(t,r,o,a,s){return c.apply(this,arguments)}}(),$=function(){var c=(0,E.Z)(l().mark(function i(t,r,o,a,s){var D;return l().wrap(function(g){for(;;)switch(g.prev=g.next){case 0:return D="/server/V1/course/create/",g.abrupt("return",(0,h.WY)(D,{method:"post",data:{request_entity:"Course",content:{related_topic:t,title:r,content:o,answer:a,hint:s}}}));case 2:case"end":return g.stop()}},i)}));return function(t,r,o,a,s){return c.apply(this,arguments)}}(),Y=function(){var c=(0,E.Z)(l().mark(function i(t){var r;return l().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return r="/server/V1/course/courses/".concat(t,"/"),a.abrupt("return",(0,h.WY)(r));case 2:case"end":return a.stop()}},i)}));return function(t){return c.apply(this,arguments)}}(),K=function(){var c=(0,E.Z)(l().mark(function i(t,r){var o;return l().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return o="/server/V1/course/courseDetail/".concat(t,"/").concat(r,"/"),s.abrupt("return",(0,h.WY)(o));case 2:case"end":return s.stop()}},i)}));return function(t,r){return c.apply(this,arguments)}}(),H=function(){var c=(0,E.Z)(l().mark(function i(t,r){var o;return l().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return o="/server/V1/course/delete/",s.abrupt("return",(0,h.WY)(o,{method:"post",data:{request_entity:"Course",related_topic:t,content:r}}));case 2:case"end":return s.stop()}},i)}));return function(t,r){return c.apply(this,arguments)}}(),z=function(){var c=(0,E.Z)(l().mark(function i(t){var r;return l().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return r="/server/V1/course/delete/",a.abrupt("return",(0,h.WY)(r,{method:"post",data:{request_entity:"Topic",content:t}}));case 2:case"end":return a.stop()}},i)}));return function(t){return c.apply(this,arguments)}}(),N=function(){var c=(0,E.Z)(l().mark(function i(t,r){var o;return l().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return o="/server/V1/course/sort/",s.abrupt("return",(0,h.WY)(o,{method:"post",data:{request_entity:"Course",related_topic:t,content:r}}));case 2:case"end":return s.stop()}},i)}));return function(t,r){return c.apply(this,arguments)}}(),X=function(){var c=(0,E.Z)(l().mark(function i(t,r){var o;return l().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return o="/server/V1/course/delete_img/",s.abrupt("return",(0,h.WY)(o,{method:"post",data:{request_entity:r,fname:t}}));case 2:case"end":return s.stop()}},i)}));return function(t,r){return c.apply(this,arguments)}}()}}]);
