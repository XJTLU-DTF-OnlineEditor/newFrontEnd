(self.webpackChunkant_design_pro=self.webpackChunkant_design_pro||[]).push([[749],{97749:function(q,b,e){"use strict";e.r(b),e.d(b,{default:function(){return de}});var j=e(58024),P=e(91894),l=e(13062),h=e(71230),Q=e(13254),V=e(14277),X=e(34792),W=e(48086),L=e(3182),K=e(69610),H=e(54941),z=e(3372),N=e(81306),U=e(72936),k=e(402),c=e(72031),i=e(94043),t=e.n(i),r=e(67294),u=e(49101),a=e(21010),s=e(11021),S=e(29811),D=e(79752),C=e(1798),$=e.n(C),w=e(45587),G=e(11849),fe=e(20136),_=e(55241),pe=e(57663),ee=e(71577),ve=e(49111),J=e(19650),te=e(2824),re=e(24285),ne=e(42762),ae=e(95357),se=e(8212),ie=e(40376),oe=e(73171),n=e(85893),ue=c.Z.Text,he=c.Z.Link;function ce(m){var Y=(0,r.useState)(!1),R=(0,te.Z)(Y,2),o=R[0],F=R[1],T=(0,w.nB)({id:m.id}),M=T.attributes,g=T.listeners,f=T.setNodeRef,v=T.transform,p=T.transition,y={transform:re.ux.Transform.toString(v),transition:p,cursor:"grab",margin:"10px"},Z=["#7193f1","#ffda6c","#00bcd4","#ef769f"],d=["#7193f122","#ffda6c22","#00bcd422","#ef769f22"],A=function(B){var O=B.icon,x=B.text;return(0,n.jsxs)("span",{children:[r.createElement(O,{style:{marginRight:8}}),x]})};return(0,n.jsx)(n.Fragment,{children:(0,n.jsx)("div",(0,G.Z)((0,G.Z)((0,G.Z)({ref:f,style:y},M),g),{},{onMouseEnter:function(){F(!0)},onMouseLeave:function(){F(!1)},children:(0,n.jsxs)(P.Z,{bordered:!1,className:"item",style:{borderLeft:"3px solid ".concat(Z[(m.topic_info.topic_id-1)%4]),backgroundColor:o?"".concat(d[(m.topic_info.topic_id-1)%4]):"white"},children:[(0,n.jsxs)(J.Z,{children:[(0,n.jsx)(ne.Z,{style:{cursor:"grab",color:"".concat(Z[(m.topic_info.topic_id-1)%4])}}),"\xA0",(0,n.jsx)(ue,{style:{color:Z[(m.topic_id-1)%4]},children:m.id}),m.item.title,"\xA0"]}),(0,n.jsxs)(J.Z,{style:{float:"right",display:o?"inline-flex":"none"},children:[(0,n.jsx)("a",{href:"/courseAdmin/courseManager?topic_title="+m.topic_info.topic_title+"&id="+m.id,children:(0,n.jsxs)("span",{children:[r.createElement(ae.Z,{style:{marginRight:8}}),(0,n.jsx)(a._H,{id:"pages.common.view"})]})}),(0,n.jsx)("a",{href:"/courseAdmin/courseManager?topic_title="+m.topic_info.topic_title+"&id="+m.id,children:(0,n.jsxs)("span",{children:[r.createElement(se.Z,{style:{marginRight:8}}),(0,n.jsx)(a._H,{id:"pages.common.edit"})]})}),(0,n.jsx)(_.Z,{content:(0,n.jsxs)("div",{children:[(0,n.jsx)(h.Z,{children:(0,n.jsxs)("span",{children:[(0,n.jsx)(ie.Z,{twoToneColor:"#faad14",style:{marginRight:8}}),(0,n.jsx)(a._H,{id:"pages.des.del"})]})}),(0,n.jsx)(h.Z,{justify:"end",children:(0,n.jsx)(J.Z,{children:(0,n.jsx)(ee.Z,{type:"primary",size:"small",onMouseUp:(0,L.Z)(t().mark(function E(){var B;return t().wrap(function(x){for(;;)switch(x.prev=x.next){case 0:return x.next=2,(0,s.A)(m.topic_info.topic_title,[m.id]);case 2:B=x.sent,B.error_code==200?(W.default.success("Delete success"),PubSub.publish("update",!0)):W.default.error("Delete error");case 4:case"end":return x.stop()}},E)})),children:(0,n.jsx)(a._H,{id:"pages.common.yes"})})})})]}),children:(0,n.jsx)("a",{children:(0,n.jsxs)("span",{children:[r.createElement(oe.Z,{style:{marginRight:8}}),(0,n.jsx)(a._H,{id:"pages.common.delete"})]})})})]})]})}))})}var le=c.Z.Title,de=function(m){(0,N.Z)(R,m);var Y=(0,U.Z)(R);function R(){var o;(0,K.Z)(this,R);for(var F=arguments.length,T=new Array(F),M=0;M<F;M++)T[M]=arguments[M];return o=Y.call.apply(Y,[this].concat(T)),o.state={selectedRowKeys:[],dataSource:[]},o.teacher_info=r.createRef(),o.topic_info=o.props.topic_info||o.props.location.query,o.color=["#7193f1","#ffda6c","#00bcd4","#ef769f"],o.overColor=["#F6F8FE","#FFFDF5","#EEFBFC","#FEF6F9"],o.handleDragEnd=function(g){var f=g.active,v=g.over,p=o.state.dataSource;if(f.id!==v.id){var y=p.map(function(d){return d.id}).indexOf(f.id),Z=p.map(function(d){return d.id}).indexOf(v.id);console.log(y,Z,444),p=(0,w.Rp)(p,y,Z),o.setState({dataSource:p}),o.handleDragSortEnd(p)}},o.getDataSource=(0,L.Z)(t().mark(function g(){var f,v,p,y;return t().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return d.next=2,(0,S.ar)();case 2:return f=d.sent,o.teacher_info.current=f.data,v=o.topic_info.topic_title,d.next=7,(0,a.WY)("/server/V1/course/courses/".concat(v,"/"));case 7:p=d.sent,p.error_code==200?(y=p.course_list.map(function(A){var E=A.fields;return E.id=A.pk,E}),y.forEach(function(A){A.update_date=new Date(A.update_date)}),o.setState({dataSource:y})):o.setState({dataSource:null});case 9:case"end":return d.stop()}},g)})),o.handleDragSortEnd=function(){var g=(0,L.Z)(t().mark(function f(v){var p,y,Z,d,A,E;return t().wrap(function(O){for(;;)switch(O.prev=O.next){case 0:return console.log("\u6392\u5E8F\u540E\u7684\u6570\u636E",v),p=o.topic_info.topic_title,y=o.state.dataSource,Z=y.map(function(x,I){return{id:x.id,subtopic_id:I+1}}),d=v.map(function(x,I){return{id:x.id,subtopic_id:I+1}}),A=d.filter(function(x,I){return x.id!=Z[I].id}),O.next=8,(0,s.BW)(p,A);case 8:E=O.sent,E.error_code==200?(o.setState({dataSource:v}),W.default.success("Modified course order successfully")):W.default.error("Failed to modify course order! ",E.msg);case 10:case"end":return O.stop()}},f)}));return function(f){return g.apply(this,arguments)}}(),o.handleDelete=(0,L.Z)(t().mark(function g(){var f,v,p,y;return t().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return f=(0,z.Z)(o),v=f.table,p=o.state.selectedRowKeys,d.next=4,(0,s.A)(o.topic_info.topic_title,p);case 4:y=d.sent,y.error_code==200?W.default.success("Delete success"):W.default.error("Delete error"),v.reload();case 7:case"end":return d.stop()}},g)})),o}return(0,H.Z)(R,[{key:"componentDidMount",value:function(){var F=this;this.getDataSource(),$().subscribe("update",function(T,M){F.getDataSource()})}},{key:"render",value:function(){var F=this,T=function(v){F.setState({selectedRowKeys:v})},M=this.state.dataSource,g=this.topic_info;return console.log(),(0,n.jsxs)(n.Fragment,{children:[M?(0,n.jsx)(D.LB,{collisionDetection:D.pE,onDragEnd:this.handleDragEnd,children:(0,n.jsx)(w.Fo,{items:this.state.dataSource,strategy:w.qw,children:this.state.dataSource.map(function(f){return(0,n.jsx)(ce,{item:f,id:f.id,topic_info:g},f.id)})})}):(0,n.jsx)(V.Z,{image:V.Z.PRESENTED_IMAGE_SIMPLE,description:(0,n.jsx)(a._H,{id:"pages.common.des.empty"})}),(0,n.jsx)(P.Z,{className:"item",bordered:!1,style:{backgroundColor:"".concat(this.overColor[(g.topic_id-1)%4]),cursor:"pointer",margin:"10px"},onClick:function(){window.location.href="/courseAdmin/courseManager?topic_title="+g.topic_title},children:(0,n.jsx)(h.Z,{justify:"center",children:(0,n.jsxs)(le,{level:5,style:{color:"grey",fontWeight:"normal"},children:[(0,n.jsx)(u.Z,{}),"\xA0",(0,n.jsx)(a._H,{id:"pages.courseList.newCourse"})]})})})]})}}]),R}(r.Component)},11021:function(q,b,e){"use strict";e.d(b,{D0:function(){return Q},wA:function(){return V},tu:function(){return X},rq:function(){return W},xH:function(){return L},G$:function(){return K},Sp:function(){return H},A:function(){return z},BK:function(){return N},BW:function(){return U},EI:function(){return k}});var j=e(3182),P=e(94043),l=e.n(P),h=e(21010),Q=function(){var c=(0,j.Z)(l().mark(function i(t){var r;return l().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return console.log(9999),console.log(t,9999),r="/server/V1/course/topicsByTeacher/?teacher_id=".concat(t),a.abrupt("return",(0,h.WY)(r));case 4:case"end":return a.stop()}},i)}));return function(t){return c.apply(this,arguments)}}(),V=function(){var c=(0,j.Z)(l().mark(function i(t,r){var u;return l().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return u="/server/V1/course/edit/",s.abrupt("return",(0,h.WY)(u,{method:"post",data:{request_entity:"Topic",content:{topic_id:t,topic_info:r}}}));case 2:case"end":return s.stop()}},i)}));return function(t,r){return c.apply(this,arguments)}}(),X=function(){var c=(0,j.Z)(l().mark(function i(t,r,u,a,s,S,D){var C;return l().wrap(function(w){for(;;)switch(w.prev=w.next){case 0:return C="/server/V1/course/edit/",w.abrupt("return",(0,h.WY)(C,{method:"post",data:{request_entity:"Course",content:{id:t,related_topic:r,title:u,content:a,answer:s,hint:S,code:D}}}));case 2:case"end":return w.stop()}},i)}));return function(t,r,u,a,s,S,D){return c.apply(this,arguments)}}(),W=function(){var c=(0,j.Z)(l().mark(function i(t,r,u,a,s){var S;return l().wrap(function(C){for(;;)switch(C.prev=C.next){case 0:return S="/server/V1/course/create/",C.abrupt("return",(0,h.WY)(S,{method:"post",data:{request_entity:"Topic",content:{topic_title:t,topic_content:r,topic_description:u,topic_img:a,teacher_id:s}}}));case 2:case"end":return C.stop()}},i)}));return function(t,r,u,a,s){return c.apply(this,arguments)}}(),L=function(){var c=(0,j.Z)(l().mark(function i(t,r,u,a,s,S){var D;return l().wrap(function($){for(;;)switch($.prev=$.next){case 0:return D="/server/V1/course/create/",$.abrupt("return",(0,h.WY)(D,{method:"post",data:{request_entity:"Course",content:{related_topic:t,title:r,content:u,answer:a,hint:s,code:S}}}));case 2:case"end":return $.stop()}},i)}));return function(t,r,u,a,s,S){return c.apply(this,arguments)}}(),K=function(){var c=(0,j.Z)(l().mark(function i(t){var r;return l().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return r="/server/V1/course/courses/".concat(t,"/"),a.abrupt("return",(0,h.WY)(r));case 2:case"end":return a.stop()}},i)}));return function(t){return c.apply(this,arguments)}}(),H=function(){var c=(0,j.Z)(l().mark(function i(t,r){var u;return l().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return u="/server/V1/course/courseDetail/".concat(t,"/").concat(r,"/"),s.abrupt("return",(0,h.WY)(u));case 2:case"end":return s.stop()}},i)}));return function(t,r){return c.apply(this,arguments)}}(),z=function(){var c=(0,j.Z)(l().mark(function i(t,r){var u;return l().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return u="/server/V1/course/delete/",s.abrupt("return",(0,h.WY)(u,{method:"post",data:{request_entity:"Course",related_topic:t,content:r}}));case 2:case"end":return s.stop()}},i)}));return function(t,r){return c.apply(this,arguments)}}(),N=function(){var c=(0,j.Z)(l().mark(function i(t){var r;return l().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return r="/server/V1/course/delete/",a.abrupt("return",(0,h.WY)(r,{method:"post",data:{request_entity:"Topic",content:t}}));case 2:case"end":return a.stop()}},i)}));return function(t){return c.apply(this,arguments)}}(),U=function(){var c=(0,j.Z)(l().mark(function i(t,r){var u;return l().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return u="/server/V1/course/sort/",s.abrupt("return",(0,h.WY)(u,{method:"post",data:{request_entity:"Course",related_topic:t,content:r}}));case 2:case"end":return s.stop()}},i)}));return function(t,r){return c.apply(this,arguments)}}(),k=function(){var c=(0,j.Z)(l().mark(function i(t,r){var u;return l().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return u="/server/V1/course/delete_img/",s.abrupt("return",(0,h.WY)(u,{method:"post",data:{request_entity:r,fname:t}}));case 2:case"end":return s.stop()}},i)}));return function(t,r){return c.apply(this,arguments)}}()}}]);
