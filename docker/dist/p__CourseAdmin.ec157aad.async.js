(self.webpackChunkant_design_pro=self.webpackChunkant_design_pro||[]).push([[667],{13745:function(q,I,t){"use strict";t.r(I),t.d(I,{default:function(){return V}});var ee=t(13062),M=t(71230),te=t(89032),O=t(15746),ne=t(62350),R=t(75443),se=t(12968),U=t(84737),y=t(86582),ie=t(34792),g=t(48086),m=t(3182),b=t(69610),L=t(54941),N=t(81306),Z=t(72936),oe=t(402),J=t(72031),re=t(58024),B=t(91894),W=t(94043),E=t.n(W),j=t(67294),F=t(95357),H=t(8212),S=t(73171),z=t(65278),Y=t(57895),h=t(11021),D=t(90672),T=t(26743),P=t(37476),v=t(5966),w=t(49101),k=t(29811),s=t(21010),G=t(97749),Q=t(34840),e=t(85893),X=B.Z.Meta,x=J.Z.Title,V=function($){(0,N.Z)(C,$);var K=(0,Z.Z)(C);function C(){var _;(0,b.Z)(this,C);for(var p=arguments.length,f=new Array(p),o=0;o<p;o++)f[o]=arguments[o];return _=K.call.apply(K,[this].concat(f)),_.state={topics:[],file:""},_.teacher_info=j.createRef(),_.formRef=j.createRef(),_.getTopics=(0,m.Z)(E().mark(function l(){var c,n;return E().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,(0,k.ar)();case 2:return c=i.sent,_.teacher_info.current=c.data,i.next=6,(0,h.D0)(_.teacher_info.current.userid);case 6:n=i.sent,console.log(_.teacher_info.current.userid,88888),n.error_code==200&&_.setState({topics:n.data.map(function(r){var d=r.fields;return d.topic_id=r.pk,d.topic_img&&(d.topic_img={url:"/media/"+d.topic_img,name:d.topic_img}),d})});case 9:case"end":return i.stop()}},l)})),_.addNewTopic=function(){var l=(0,m.Z)(E().mark(function c(n){var a,i,r,d;return E().wrap(function(A){for(;;)switch(A.prev=A.next){case 0:if(console.log(n),a=_.teacher_info.current.userid,!(!n.topic_content||!n.topic_title)){A.next=5;break}return g.default.error("please input the topic_title and the topic_content"),A.abrupt("return",!1);case 5:return A.next=7,(0,h.rq)(n.topic_title,n.topic_content,n.topic_description,_.state.file,a);case 7:if(i=A.sent,i.error_code!=200){A.next=16;break}return d={topic_id:i.id,topic_description:n.topic_description,topic_title:n.topic_title,topic_content:n.topic_content,topic_img:_.state.file},_.setState({topics:[].concat((0,y.Z)(_.state.topics),[d])}),g.default.success("topic has been created successfully"),(r=_.formRef.current)===null||r===void 0||r.resetFields(),A.abrupt("return",!0);case 16:return g.default.error(i.msg),A.abrupt("return",!1);case 18:case"end":return A.stop()}},c)}));return function(c){return l.apply(this,arguments)}}(),_.confirm=function(){var l=(0,m.Z)(E().mark(function c(n){var a;return E().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,(0,h.BK)(n);case 2:a=r.sent,a.error_code==200?(g.default.success("Delete success."),_.getTopics()):g.default.success("Fail to delete. Please try again later");case 4:case"end":return r.stop()}},c)}));return function(c){return l.apply(this,arguments)}}(),_.handleChange=function(){var l=(0,m.Z)(E().mark(function c(n){var a,i;return E().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:if(console.log(n),a=n.file,!(a&&a.status=="done"&&a.response)){d.next=6;break}a.name=a.response.imgUrl,d.next=12;break;case 6:if(a.status!="removed"){d.next=12;break}return d.next=9,(0,h.EI)(a.name,"Topic");case 9:i=d.sent,console.log(i),a=void 0;case 12:_.setState({file:a});case 13:case"end":return d.stop()}},c)}));return function(c){return l.apply(this,arguments)}}(),_}return(0,L.Z)(C,[{key:"componentDidMount",value:function(){this.getTopics()}},{key:"render",value:function(){var p=this,f=function(l){var c=l.icon,n=l.text;return(0,e.jsxs)("span",{children:[j.createElement(c,{style:{marginRight:8}}),n]})};return(0,e.jsx)("div",{style:{background:"#F5F7FA"},children:(0,e.jsxs)(z.ZP,{header:{title:(0,e.jsxs)(x,{level:2,children:[" ",(0,e.jsx)(s._H,{id:"pages.courseAdmin.title"})]}),ghost:!0,breadcrumb:{}},children:[(0,e.jsx)(B.Z,{children:(0,e.jsx)(M.Z,{gutter:{xs:16,sm:24,md:32},children:this.state.topics.map(function(o){return(0,e.jsx)(O.Z,{span:8,children:(0,e.jsxs)(B.Z,{hoverable:!0,className:"course-card",style:{marginTop:"20px"},cover:(0,e.jsx)("img",{alt:o.topic_img.title,src:o.topic_img.url}),actions:[(0,e.jsx)(P.Y,{title:(0,e.jsx)(s._H,{id:"pages.common.view"}),initialValues:o,trigger:(0,e.jsx)("a",{children:(0,e.jsx)(f,{icon:F.Z,text:(0,e.jsx)(s._H,{id:"pages.common.view"})},"list-vertical-message")}),submitter:{render:function(c,n){return[]}},children:(0,e.jsxs)(Q.ZP,{column:2,children:[(0,e.jsx)(Q.ZP.Item,{span:2,valueType:"text",contentStyle:{maxWidth:"80%"},label:(0,e.jsx)("b",{children:(0,e.jsx)(s._H,{id:"pages.courseAdmin.topicTitle"})}),children:o.topic_title}),(0,e.jsx)(Q.ZP.Item,{span:2,valueType:"text",contentStyle:{maxWidth:"80%"},label:(0,e.jsx)("b",{children:(0,e.jsx)(s._H,{id:"pages.courseAdmin.topicDescription"})}),children:o.topic_description}),(0,e.jsx)(Q.ZP.Item,{span:2,valueType:"text",contentStyle:{maxWidth:"80%"},label:(0,e.jsx)("b",{children:(0,e.jsx)(s._H,{id:"pages.courseAdmin.topicContent"})}),children:o.topic_content}),(0,e.jsx)(Q.ZP.Item,{span:2,valueType:"avatar",contentStyle:{maxWidth:"80%"},label:(0,e.jsx)("b",{children:(0,e.jsx)(s._H,{id:"pages.courseAdmin.topicCover"})}),children:(0,e.jsx)(U.Z,{alt:o.name,height:200,src:o.topic_img.url,fallback:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAMIAAADDCAYAAADQvc6UAAABRWlDQ1BJQ0MgUHJvZmlsZQAAKJFjYGASSSwoyGFhYGDIzSspCnJ3UoiIjFJgf8LAwSDCIMogwMCcmFxc4BgQ4ANUwgCjUcG3awyMIPqyLsis7PPOq3QdDFcvjV3jOD1boQVTPQrgSkktTgbSf4A4LbmgqISBgTEFyFYuLykAsTuAbJEioKOA7DkgdjqEvQHEToKwj4DVhAQ5A9k3gGyB5IxEoBmML4BsnSQk8XQkNtReEOBxcfXxUQg1Mjc0dyHgXNJBSWpFCYh2zi+oLMpMzyhRcASGUqqCZ16yno6CkYGRAQMDKMwhqj/fAIcloxgHQqxAjIHBEugw5sUIsSQpBobtQPdLciLEVJYzMPBHMDBsayhILEqEO4DxG0txmrERhM29nYGBddr//5/DGRjYNRkY/l7////39v///y4Dmn+LgeHANwDrkl1AuO+pmgAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAwqADAAQAAAABAAAAwwAAAAD9b/HnAAAHlklEQVR4Ae3dP3PTWBSGcbGzM6GCKqlIBRV0dHRJFarQ0eUT8LH4BnRU0NHR0UEFVdIlFRV7TzRksomPY8uykTk/zewQfKw/9znv4yvJynLv4uLiV2dBoDiBf4qP3/ARuCRABEFAoBEgghggQAQZQKAnYEaQBAQaASKIAQJEkAEEegJmBElAoBEgghggQAQZQKAnYEaQBAQaASKIAQJEkAEEegJmBElAoBEgghggQAQZQKAnYEaQBAQaASKIAQJEkAEEegJmBElAoBEgghggQAQZQKAnYEaQBAQaASKIAQJEkAEEegJmBElAoBEgghggQAQZQKAnYEaQBAQaASKIAQJEkAEEegJmBElAoBEgghggQAQZQKAnYEaQBAQaASKIAQJEkAEEegJmBElAoBEgghggQAQZQKAnYEaQBAQaASKIAQJEkAEEegJmBElAoBEgghggQAQZQKAnYEaQBAQaASKIAQJEkAEEegJmBElAoBEgghggQAQZQKAnYEaQBAQaASKIAQJEkAEEegJmBElAoBEgghggQAQZQKAnYEaQBAQaASKIAQJEkAEEegJmBElAoBEgghggQAQZQKAnYEaQBAQaASKIAQJEkAEEegJmBElAoBEgghggQAQZQKAnYEaQBAQaASKIAQJEkAEEegJmBElAoBEgghgg0Aj8i0JO4OzsrPv69Wv+hi2qPHr0qNvf39+iI97soRIh4f3z58/u7du3SXX7Xt7Z2enevHmzfQe+oSN2apSAPj09TSrb+XKI/f379+08+A0cNRE2ANkupk+ACNPvkSPcAAEibACyXUyfABGm3yNHuAECRNgAZLuYPgEirKlHu7u7XdyytGwHAd8jjNyng4OD7vnz51dbPT8/7z58+NB9+/bt6jU/TI+AGWHEnrx48eJ/EsSmHzx40L18+fLyzxF3ZVMjEyDCiEDjMYZZS5wiPXnyZFbJaxMhQIQRGzHvWR7XCyOCXsOmiDAi1HmPMMQjDpbpEiDCiL358eNHurW/5SnWdIBbXiDCiA38/Pnzrce2YyZ4//59F3ePLNMl4PbpiL2J0L979+7yDtHDhw8vtzzvdGnEXdvUigSIsCLAWavHp/+qM0BcXMd/q25n1vF57TYBp0a3mUzilePj4+7k5KSLb6gt6ydAhPUzXnoPR0dHl79WGTNCfBnn1uvSCJdegQhLI1vvCk+fPu2ePXt2tZOYEV6/fn31dz+shwAR1sP1cqvLntbEN9MxA9xcYjsxS1jWR4AIa2Ibzx0tc44fYX/16lV6NDFLXH+YL32jwiACRBiEbf5KcXoTIsQSpzXx4N28Ja4BQoK7rgXiydbHjx/P25TaQAJEGAguWy0+2Q8PD6/Ki4R8EVl+bzBOnZY95fq9rj9zAkTI2SxdidBHqG9+skdw43borCXO/ZcJdraPWdv22uIEiLA4q7nvvCug8WTqzQveOH26fodo7g6uFe/a17W3+nFBAkRYENRdb1vkkz1CH9cPsVy/jrhr27PqMYvENYNlHAIesRiBYwRy0V+8iXP8+/fvX11Mr7L7ECueb/r48eMqm7FuI2BGWDEG8cm+7G3NEOfmdcTQw4h9/55lhm7DekRYKQPZF2ArbXTAyu4kDYB2YxUzwg0gi/41ztHnfQG26HbGel/crVrm7tNY+/1btkOEAZ2M05r4FB7r9GbAIdxaZYrHdOsgJ/wCEQY0J74TmOKnbxxT9n3FgGGWWsVdowHtjt9Nnvf7yQM2aZU/TIAIAxrw6dOnAWtZZcoEnBpNuTuObWMEiLAx1HY0ZQJEmHJ3HNvGCBBhY6jtaMoEiJB0Z29vL6ls58vxPcO8/zfrdo5qvKO+d3Fx8Wu8zf1dW4p/cPzLly/dtv9Ts/EbcvGAHhHyfBIhZ6NSiIBTo0LNNtScABFyNiqFCBChULMNNSdAhJyNSiECRCjUbEPNCRAhZ6NSiAARCjXbUHMCRMjZqBQiQIRCzTbUnAARcjYqhQgQoVCzDTUnQIScjUohAkQo1GxDzQkQIWejUogAEQo121BzAkTI2agUIkCEQs021JwAEXI2KoUIEKFQsw01J0CEnI1KIQJEKNRsQ80JECFno1KIABEKNdtQcwJEyNmoFCJAhELNNtScABFyNiqFCBChULMNNSdAhJyNSiECRCjUbEPNCRAhZ6NSiAARCjXbUHMCRMjZqBQiQIRCzTbUnAARcjYqhQgQoVCzDTUnQIScjUohAkQo1GxDzQkQIWejUogAEQo121BzAkTI2agUIkCEQs021JwAEXI2KoUIEKFQsw01J0CEnI1KIQJEKNRsQ80JECFno1KIABEKNdtQcwJEyNmoFCJAhELNNtScABFyNiqFCBChULMNNSdAhJyNSiECRCjUbEPNCRAhZ6NSiAARCjXbUHMCRMjZqBQiQIRCzTbUnAARcjYqhQgQoVCzDTUnQIScjUohAkQo1GxDzQkQIWejUogAEQo121BzAkTI2agUIkCEQs021JwAEXI2KoUIEKFQsw01J0CEnI1KIQJEKNRsQ80JECFno1KIABEKNdtQcwJEyNmoFCJAhELNNtScABFyNiqFCBChULMNNSdAhJyNSiEC/wGgKKC4YMA4TAAAAABJRU5ErkJggg=="})})]})}),(0,e.jsxs)(P.Y,{title:(0,e.jsx)(s._H,{id:"pages.common.edit"}),initialValues:o,trigger:(0,e.jsx)("a",{children:(0,e.jsx)(f,{icon:H.Z,text:(0,e.jsx)(s._H,{id:"pages.common.edit"})},"list-vertical-star-o")}),autoFocusFirstInput:!0,onFinish:function(){var l=(0,m.Z)(E().mark(function c(n){var a;return E().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(console.log(n),!(!n.topic_content&&!n.topic_title&&!n.topic_img&&!n.topic_description)){r.next=6;break}return g.default.info("Nothing changed"),r.abrupt("return",!0);case 6:return n.topic_img&&(n.topic_img=n.topic_img[0]),r.next=9,(0,h.wA)(o.topic_id,n);case 9:if(a=r.sent,a.error_code!=200){r.next=16;break}return p.getTopics(),g.default.success("topic infomation changed success"),r.abrupt("return",!0);case 16:return g.default.error(a.msg),r.abrupt("return",!1);case 18:case"end":return r.stop()}},c)}));return function(c){return l.apply(this,arguments)}}(),submitter:{searchConfig:{submitText:(0,e.jsx)(s._H,{id:"pages.common.submit"}),resetText:(0,e.jsx)(s._H,{id:"pages.common.cancel"})}},children:[(0,e.jsx)(v.Z,{width:"md",name:"topic_title",label:(0,e.jsx)(s._H,{id:"pages.courseAdmin.topicTitle"}),placeholder:(0,s.Kd)()=="zh-CN"?"\u8BF7\u8F93\u5165\u8BE5\u4E3B\u9898\u7684\u6807\u9898":"please input a topic title"}),(0,e.jsx)(D.Z,{name:"topic_description",label:(0,e.jsx)(s._H,{id:"pages.courseAdmin.topicDescription"}),placeholder:(0,s.Kd)()=="zh-CN"?"\u8BF7\u8F93\u5165\u8BE5\u4E3B\u9898\u7684\u63CF\u8FF0":"please input a topic description"}),(0,e.jsx)(D.Z,{name:"topic_content",label:(0,e.jsx)(s._H,{id:"pages.courseAdmin.topicContent"}),placeholder:(0,s.Kd)()=="zh-CN"?"\u8BF7\u8F93\u5165\u8BE5\u4E3B\u9898\u7684\u5185\u5BB9\u4ECB\u7ECD":"please input a topic content"}),(0,e.jsx)(T.Z,{name:"topic_img",beforeUpload:p.handleBeforeUpload,fieldProps:{name:"topic_img",listType:"picture-card",accept:".jpg, .png, .jpeg, .gif"},action:"/server/V1/course/upload_topic_img/",onChange:function(){var l=(0,m.Z)(E().mark(function c(n){var a,i,r;return E().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:if(console.log(n),a=p.state.topics,i=n.file,i.status!="removed"){u.next=8;break}return u.next=6,(0,h.EI)(i.name,"Topic");case 6:r=u.sent,console.log(r);case 8:a.map(function(A){return A.topic_id==o.topic_id&&(i.status=="removed"?A.topic_img="":(i&&i.status=="done"&&i.response&&(i.name=i.response.imgUrl),A.topic_img=i)),A}),p.setState({topics:a});case 10:case"end":return u.stop()}},c)}));return function(c){return l.apply(this,arguments)}}(),label:(0,e.jsx)(s._H,{id:"pages.courseAdmin.upload"}),max:1,value:o.topic_img?[o.topic_img]:[]})]}),(0,e.jsx)(R.Z,{title:(0,e.jsx)(s._H,{id:"pages.des.delTopic"}),onConfirm:function(){return p.confirm(o.topic_id)},okText:(0,e.jsx)(s._H,{id:"pages.common.yes"}),cancelText:(0,e.jsx)(s._H,{id:"pages.common.no"}),children:(0,e.jsx)("a",{children:(0,e.jsx)(f,{icon:S.Z,text:(0,e.jsx)(s._H,{id:"pages.common.delete"})},"list-vertical-like-o")})})],children:[(0,e.jsx)(X,{title:o.topic_title,description:o.topic_description,onClick:function(){p.props.history.push("/courseAdmin/courseList?topic_title=".concat(o.topic_title,"&topic_id=").concat(o.topic_id))}}),(0,e.jsx)(Y.ZP,{title:(0,e.jsx)(s._H,{id:"pages.courseList.showCourses"}),ghost:!0,gutter:8,collapsible:!0,defaultCollapsed:!0,children:(0,e.jsx)(G.default,{topic_info:{topic_title:o.topic_title,topic_id:o.topic_id}})})]})})})})}),(0,e.jsxs)(P.Y,{title:(0,e.jsx)(s._H,{id:"pages.courseAdmin.newTopic"}),trigger:(0,e.jsx)(B.Z,{bordered:!1,style:{backgroundColor:"white",cursor:"pointer",marginTop:"10px"},children:(0,e.jsx)(M.Z,{justify:"center",children:(0,e.jsxs)(x,{level:5,style:{color:"grey",fontWeight:"normal"},children:[(0,e.jsx)(w.Z,{}),"\xA0",(0,e.jsx)(s._H,{id:"pages.courseList.newTopic"})]})})}),formRef:this.formRef,autoFocusFirstInput:!0,onFinish:function(l){return p.addNewTopic(l)},submitter:{searchConfig:{submitText:(0,e.jsx)(s._H,{id:"pages.common.submit"}),resetText:(0,e.jsx)(s._H,{id:"pages.common.cancel"})}},children:[(0,e.jsx)(v.Z,{width:"md",name:"topic_title",label:(0,e.jsx)(s._H,{id:"pages.courseAdmin.topicTitle"}),placeholder:(0,s.Kd)()=="zh-CN"?"\u8BF7\u8F93\u5165\u8BE5\u4E3B\u9898\u7684\u6807\u9898":"please input a topic title"}),(0,e.jsx)(D.Z,{name:"topic_description",label:"topic description",placeholder:(0,s.Kd)()=="zh-CN"?"\u8BF7\u8F93\u5165\u8BE5\u4E3B\u9898\u7684\u63CF\u8FF0":"please input a topic description"}),(0,e.jsx)(D.Z,{name:"topic_content",label:"topic content",placeholder:(0,s.Kd)()=="zh-CN"?"\u8BF7\u8F93\u5165\u8BE5\u4E3B\u9898\u7684\u5185\u5BB9\u4ECB\u7ECD":"please input a topic content"}),(0,e.jsx)(T.Z,{name:"topic_img",label:(0,e.jsx)(s._H,{id:"pages.courseAdmin.upload"}),max:1,beforeUpload:this.handleBeforeUpload,fieldProps:{name:"topic_img",listType:"picture-card",accept:".jpg, .png, .jpeg, .gif"},action:"/server/V1/course/upload_topic_img/",onChange:this.handleChange})]})]})})}}]),C}(j.Component)}}]);
