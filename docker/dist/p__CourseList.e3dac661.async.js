(self.webpackChunkant_design_pro=self.webpackChunkant_design_pro||[]).push([[30],{50877:function(k,K,s){"use strict";s.r(K),s.d(K,{default:function(){return T}});var v=s(57663),B=s(71577),o=s(62350),m=s(75443),Y=s(34792),M=s(48086),b=s(3182),U=s(69610),Z=s(54941),S=s(3372),F=s(81306),x=s(72936),$=s(94043),D=s.n($),z=s(67294),i=s(73171),t=s(49101),n=s(93555),e=s(21010),a=s(11021),u=s(39265),r=s(78009),d=s(85893),T=function(C){(0,F.Z)(W,C);var V=(0,x.Z)(W);function W(){var _;(0,U.Z)(this,W);for(var P=arguments.length,A=new Array(P),I=0;I<P;I++)A[I]=arguments[I];return _=V.call.apply(V,[this].concat(A)),_.state={selectedRowKeys:[],dataSource:[]},_.getDataSource=function(){var f=(0,b.Z)(D().mark(function l(c){var y,h,E;return D().wrap(function(p){for(;;)switch(p.prev=p.next){case 0:if(y=_.props.location.query.topic_title,!c.title){p.next=7;break}return p.next=4,(0,e.WY)("/server/V1/course/search/?keyword=".concat(c.title),{teacher_id:_.props.location.query.teacher_id});case 4:h=p.sent,p.next=10;break;case 7:return p.next=9,(0,e.WY)("/server/V1/course/courses/".concat(y,"/"));case 9:h=p.sent;case 10:if(h.error_code!=200){p.next=17;break}return E=h.course_list.map(function(w){var L=w.fields;return L.id=w.pk,L}),E.forEach(function(w){w.update_date=new Date(w.update_date)}),_.setState({dataSource:E}),p.abrupt("return",{data:E,success:!0,total:E.length,page:c.current});case 17:return p.abrupt("return",{success:!1,page:c.current});case 18:case"end":return p.stop()}},l)}));return function(l){return f.apply(this,arguments)}}(),_.handleDragSortEnd=function(){var f=(0,b.Z)(D().mark(function l(c){var y,h,E,g,p,w;return D().wrap(function(O){for(;;)switch(O.prev=O.next){case 0:return console.log("\u6392\u5E8F\u540E\u7684\u6570\u636E",c),y=_.props.location.query.topic_title,h=_.state.dataSource,E=h.map(function(R,j){return{id:R.id,subtopic_id:j+1}}),g=c.map(function(R,j){return{id:R.id,subtopic_id:j+1}}),p=g.filter(function(R,j){return R.id!=E[j].id}),O.next=8,(0,a.BW)(y,p);case 8:w=O.sent,w.error_code==200?(_.setState({dataSource:c}),M.default.success("Modified course order successfully")):M.default.error("Failed to modify course order! ",w.msg);case 10:case"end":return O.stop()}},l)}));return function(l){return f.apply(this,arguments)}}(),_.columns=[{title:"INDEX",dataIndex:"sort",hideInSearch:!0,width:60,render:function(l,c,y){return(0,d.jsx)("span",{className:"customRender",children:"".concat(y+1)})}},{title:"COURSE TITLE",dataIndex:"title",copyable:!0,ellipsis:!0,filters:!0,onFilter:!0},{title:"UPDATED TIME",key:"since",dataIndex:"update_date",valueType:"dateTime",hideInSearch:!0},{title:"VIEWS",dataIndex:"views",valueType:"digit",width:100,hideInSearch:!0},{title:"OPERATIONS",key:"option",valueType:"option",render:function(l,c,y,h){return[(0,d.jsx)("a",{onClick:function(){return _.props.history.push("/courseAdmin/courseDisplay?topic_title="+_.props.location.query.topic_title+"&id="+c.id)},children:"view"},"1"),(0,d.jsx)("a",{onClick:function(){return _.props.history.push("/courseAdmin/courseManager?topic_title="+_.props.location.query.topic_title+"&id="+c.id)},children:"edit"},"2"),(0,d.jsx)(m.Z,{title:"Are you sure to delete the course?",onConfirm:(0,b.Z)(D().mark(function E(){var g,p,w;return D().wrap(function(O){for(;;)switch(O.prev=O.next){case 0:return g=(0,S.Z)(_),p=g.table,O.next=3,(0,a.A)(_.props.location.query.topic_title,[c.id]);case 3:w=O.sent,w.error_code==200?M.default.success("Delete success"):M.default.error("Delete error"),p.reload();case 6:case"end":return O.stop()}},E)})),okText:"Yes",cancelText:"No",children:(0,d.jsx)("a",{children:"delete"},"3")})]}}],_.handleDelete=(0,b.Z)(D().mark(function f(){var l,c,y,h;return D().wrap(function(g){for(;;)switch(g.prev=g.next){case 0:return l=(0,S.Z)(_),c=l.table,y=_.state.selectedRowKeys,g.next=4,(0,a.A)(_.props.location.query.topic_title,y);case 4:h=g.sent,h.error_code==200?M.default.success("Delete success"):M.default.error("Delete error"),c.reload();case 7:case"end":return g.stop()}},f)})),_}return(0,Z.Z)(W,[{key:"render",value:function(){var P=this,A=this.props.location.query.topic_title,I=function(l){P.setState({selectedRowKeys:l})};return(0,d.jsx)(r.ZP,{ghost:!0,onBack:function(){return P.props.history.push("/courseAdmin")},header:{title:"Course List"},children:(0,d.jsx)(u.ZP,{children:(0,d.jsx)(n.Z,{actionRef:function(l){return P.table=l},columns:this.columns,request:(0,b.Z)(D().mark(function f(){var l,c=arguments;return D().wrap(function(h){for(;;)switch(h.prev=h.next){case 0:return l=c.length>0&&c[0]!==void 0?c[0]:{},h.abrupt("return",P.getDataSource(l));case 2:case"end":return h.stop()}},f)})),rowSelection:{selectedRowKeys:this.state.selectedRowKeys,onChange:I},editable:{type:"multiple"},columnsState:{persistenceKey:"pro-table-singe-demos",persistenceType:"localStorage"},rowKey:"id",search:{labelWidth:"auto"},form:{syncToUrl:function(l,c){return c==="get"?Object.assign(Object.assign({},l),{created_at:[l.startTime,l.endTime]}):l}},pagination:{pageSize:10},dateFormatter:"string",headerTitle:"\u3010TOPIC TITLE\u3011"+A,toolBarRender:function(){return[(0,d.jsx)(m.Z,{title:"Are you sure to delete the chosen courses?",onConfirm:P.handleDelete,okText:"Yes",cancelText:"No",children:(0,d.jsx)(B.Z,{icon:(0,d.jsx)(i.Z,{}),type:"primary",danger:!0,disabled:P.state.selectedRowKeys.length==0,children:"Delete"},"button")}),(0,d.jsx)(B.Z,{icon:(0,d.jsx)(t.Z,{}),type:"primary",children:(0,d.jsx)("a",{href:"/courseAdmin/courseManager?topic_title="+A,rel:"noopener noreferrer",style:{color:"inherit"},children:"New"},"view")},"button")]},dragSortKey:"sort",dataSource:this.state.dataSource,onDragSortEnd:this.handleDragSortEnd})})})}}]),W}(z.Component)},11021:function(k,K,s){"use strict";s.d(K,{D0:function(){return Y},wA:function(){return M},tu:function(){return b},rq:function(){return U},xH:function(){return Z},G$:function(){return S},Sp:function(){return F},A:function(){return x},BK:function(){return $},BW:function(){return D},EI:function(){return z}});var v=s(3182),B=s(94043),o=s.n(B),m=s(21010),Y=function(){var i=(0,v.Z)(o().mark(function t(n){var e;return o().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return e="/server/V1/course/topicsByTeacher/?teacher_id=".concat(n),u.abrupt("return",(0,m.WY)(e));case 2:case"end":return u.stop()}},t)}));return function(n){return i.apply(this,arguments)}}(),M=function(){var i=(0,v.Z)(o().mark(function t(n,e){var a;return o().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return a="/server/V1/course/edit/",r.abrupt("return",(0,m.WY)(a,{method:"post",data:{request_entity:"Topic",content:{topic_id:n,topic_info:e}}}));case 2:case"end":return r.stop()}},t)}));return function(n,e){return i.apply(this,arguments)}}(),b=function(){var i=(0,v.Z)(o().mark(function t(n,e,a,u,r){var d;return o().wrap(function(C){for(;;)switch(C.prev=C.next){case 0:return d="/server/V1/course/edit/",C.abrupt("return",(0,m.WY)(d,{method:"post",data:{request_entity:"Course",content:{id:n,related_topic:e,title:a,content:u,teacher_id:r}}}));case 2:case"end":return C.stop()}},t)}));return function(n,e,a,u,r){return i.apply(this,arguments)}}(),U=function(){var i=(0,v.Z)(o().mark(function t(n,e,a,u){var r;return o().wrap(function(T){for(;;)switch(T.prev=T.next){case 0:return r="/server/V1/course/create/",T.abrupt("return",(0,m.WY)(r,{method:"post",data:{request_entity:"Topic",content:{topic_title:n,topic_content:e,topic_img:a,teacher_id:u}}}));case 2:case"end":return T.stop()}},t)}));return function(n,e,a,u){return i.apply(this,arguments)}}(),Z=function(){var i=(0,v.Z)(o().mark(function t(n,e,a,u){var r;return o().wrap(function(T){for(;;)switch(T.prev=T.next){case 0:return r="/server/V1/course/create/",T.abrupt("return",(0,m.WY)(r,{method:"post",data:{request_entity:"Course",content:{related_topic:n,title:e,content:a,teacher_id:u}}}));case 2:case"end":return T.stop()}},t)}));return function(n,e,a,u){return i.apply(this,arguments)}}(),S=function(){var i=(0,v.Z)(o().mark(function t(n){var e;return o().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return e="/server/V1/course/courses/".concat(n,"/"),u.abrupt("return",(0,m.WY)(e));case 2:case"end":return u.stop()}},t)}));return function(n){return i.apply(this,arguments)}}(),F=function(){var i=(0,v.Z)(o().mark(function t(n,e){var a;return o().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return a="/server/V1/course/courseDetail/".concat(n,"/").concat(e,"/"),r.abrupt("return",(0,m.WY)(a));case 2:case"end":return r.stop()}},t)}));return function(n,e){return i.apply(this,arguments)}}(),x=function(){var i=(0,v.Z)(o().mark(function t(n,e){var a;return o().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return a="/server/V1/course/delete/",r.abrupt("return",(0,m.WY)(a,{method:"post",data:{request_entity:"Course",related_topic:n,content:e}}));case 2:case"end":return r.stop()}},t)}));return function(n,e){return i.apply(this,arguments)}}(),$=function(){var i=(0,v.Z)(o().mark(function t(n){var e;return o().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return e="/server/V1/course/delete/",u.abrupt("return",(0,m.WY)(e,{method:"post",data:{request_entity:"Topic",content:n}}));case 2:case"end":return u.stop()}},t)}));return function(n){return i.apply(this,arguments)}}(),D=function(){var i=(0,v.Z)(o().mark(function t(n,e){var a;return o().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return a="/server/V1/course/sort/",r.abrupt("return",(0,m.WY)(a,{method:"post",data:{request_entity:"Course",related_topic:n,content:e}}));case 2:case"end":return r.stop()}},t)}));return function(n,e){return i.apply(this,arguments)}}(),z=function(){var i=(0,v.Z)(o().mark(function t(n,e){var a;return o().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return a="/server/V1/course/delete_img/",r.abrupt("return",(0,m.WY)(a,{method:"post",data:{request_entity:e,fname:n}}));case 2:case"end":return r.stop()}},t)}));return function(n,e){return i.apply(this,arguments)}}()}}]);
