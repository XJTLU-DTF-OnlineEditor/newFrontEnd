(self.webpackChunkant_design_pro=self.webpackChunkant_design_pro||[]).push([[667],{13745:function(N,R,t){"use strict";t.r(R),t.d(R,{default:function(){return k}});var P=t(62350),U=t(75443),_=t(57663),D=t(71577),Z=t(86582),Y=t(34792),b=t(48086),w=t(3182),L=t(69610),K=t(54941),F=t(81306),$=t(72936),V=t(94043),v=t.n(V),A=t(67294),l=t(95357),r=t(8212),n=t(73171),i=t(30577),o=t(78009),s=t(39265),e=t(11021),j=t(90672),T=t(26743),y=t(37476),z=t(5966),G=t(49101),c=t(85893),k=function(H){(0,F.Z)(x,H);var S=(0,$.Z)(x);function x(){var E;(0,L.Z)(this,x);for(var M=arguments.length,I=new Array(M),C=0;C<M;C++)I[C]=arguments[C];return E=S.call.apply(S,[this].concat(I)),E.state={topics:[],file:""},E.formRef=A.createRef(),E.getTopics=(0,w.Z)(v().mark(function h(){var p,d;return v().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return p=1,u.next=3,(0,e.D0)(p);case 3:d=u.sent,console.log(d),d.error_code==200&&E.setState({topics:d.data.map(function(f){var a=f.fields;return a.topic_id=f.pk,a.topic_img&&(a.topic_img={url:"/media/"+a.topic_img,name:a.topic_img}),a})});case 6:case"end":return u.stop()}},h)})),E.addNewTopic=function(){var h=(0,w.Z)(v().mark(function p(d){var m,u,f,a;return v().wrap(function(O){for(;;)switch(O.prev=O.next){case 0:if(console.log(d),m=1,!(!d.topic_content||!d.topic_title)){O.next=5;break}return b.default.error("please input the topic_title and the topic_content"),O.abrupt("return",!1);case 5:return O.next=7,(0,e.rq)(d.topic_title,d.topic_content,E.state.file,m);case 7:if(u=O.sent,u.error_code!=200){O.next=16;break}return a={topic_id:u.id,topic_title:d.topic_title,topic_content:d.topic_content,topic_img:E.state.file},E.setState({topics:[].concat((0,Z.Z)(E.state.topics),[a])}),b.default.success("topic has been created successfully"),(f=E.formRef.current)===null||f===void 0||f.resetFields(),O.abrupt("return",!0);case 16:return b.default.error(u.msg),O.abrupt("return",!1);case 18:case"end":return O.stop()}},p)}));return function(p){return h.apply(this,arguments)}}(),E.confirm=function(){var h=(0,w.Z)(v().mark(function p(d){var m;return v().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:return f.next=2,(0,e.BK)(d);case 2:m=f.sent,m.error_code==200?(b.default.success("Delete success."),E.getTopics()):b.default.success("Fail to delete. Please try again later");case 4:case"end":return f.stop()}},p)}));return function(p){return h.apply(this,arguments)}}(),E.handleChange=function(){var h=(0,w.Z)(v().mark(function p(d){var m,u;return v().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(m=d.file,!(m&&m.status=="done"&&m.response)){a.next=5;break}m.name=m.response.imgUrl,a.next=11;break;case 5:if(m.status!="removed"){a.next=11;break}return a.next=8,(0,e.EI)(m.name,"Topic");case 8:u=a.sent,console.log(u),m=void 0;case 11:E.setState({file:m});case 12:case"end":return a.stop()}},p)}));return function(p){return h.apply(this,arguments)}}(),E}return(0,K.Z)(x,[{key:"componentDidMount",value:function(){this.getTopics()}},{key:"render",value:function(){var M=this,I=function(h){var p=h.icon,d=h.text;return(0,c.jsxs)("span",{children:[A.createElement(p,{style:{marginRight:8}}),d]})};return(0,c.jsx)("div",{style:{background:"#F5F7FA"},children:(0,c.jsx)(o.ZP,{header:{title:"Course Management",ghost:!0,breadcrumb:{}},children:(0,c.jsx)(s.ZP,{children:(0,c.jsx)(i.Z,{toolBarRender:function(){return[(0,c.jsxs)(y.Z,{title:"Add a new topic",trigger:(0,c.jsxs)(D.Z,{type:"primary",children:[(0,c.jsx)(G.Z,{}),"NEW"]}),formRef:M.formRef,autoFocusFirstInput:!0,onFinish:function(p){return M.addNewTopic(p)},submitter:{searchConfig:{submitText:"submit",resetText:"cancel"}},children:[(0,c.jsx)(z.Z,{width:"md",name:"topic_title",label:"Topic Title",placeholder:"please input a topic title"}),(0,c.jsx)(j.Z,{name:"topic_content",label:"topic description",placeholder:"please input topic description",width:"xl"}),(0,c.jsx)(T.Z,{name:"topic_img",label:"Upload",max:1,beforeUpload:M.handleBeforeUpload,fieldProps:{name:"topic_img",listType:"picture-card",accept:".jpg, .png, .jpeg, .gif"},action:"/server/V1/course/upload_topic_img/",onChange:M.handleChange})]})]},itemLayout:"vertical",rowKey:"topic_id",headerTitle:"Topics",dataSource:this.state.topics,metas:{title:{dataIndex:"topic_title",render:function(h){return(0,c.jsx)("a",{href:"/courseAdmin/courseList?topic_title=".concat(h),style:{textDecoration:"none",color:"#333"},children:h})}},actions:{render:function(h,p){return[(0,c.jsx)("a",{href:"/courseAdmin/courseList?topic_title=".concat(p.topic_title),children:(0,c.jsx)(I,{icon:l.Z,text:"view"},"list-vertical-message")}),(0,c.jsxs)(y.Z,{title:"EDIT",initialValues:p,trigger:(0,c.jsx)("a",{children:(0,c.jsx)(I,{icon:r.Z,text:"edit"},"list-vertical-star-o")}),autoFocusFirstInput:!0,onFinish:function(){var d=(0,w.Z)(v().mark(function m(u){var f;return v().wrap(function(g){for(;;)switch(g.prev=g.next){case 0:if(console.log(u),!(!u.topic_content&&!u.topic_title&&!u.topic_img)){g.next=6;break}return b.default.info("Nothing changed"),g.abrupt("return",!0);case 6:return u.topic_img&&(u.topic_img=u.topic_img[0]),g.next=9,(0,e.wA)(p.topic_id,u);case 9:if(f=g.sent,f.error_code!=200){g.next=16;break}return M.getTopics(),b.default.success("topic infomation changed success"),g.abrupt("return",!0);case 16:return b.default.error(f.msg),g.abrupt("return",!1);case 18:case"end":return g.stop()}},m)}));return function(m){return d.apply(this,arguments)}}(),submitter:{searchConfig:{submitText:"submit",resetText:"cancel"}},children:[(0,c.jsx)(z.Z,{width:"md",name:"topic_title",label:"Topic Title",placeholder:"please input a topic title"}),(0,c.jsx)(j.Z,{name:"topic_content",label:"topic description",placeholder:"please input topic description"}),(0,c.jsx)(T.Z,{name:"topic_img",beforeUpload:M.handleBeforeUpload,fieldProps:{name:"topic_img",listType:"picture-card",accept:".jpg, .png, .jpeg, .gif"},action:"/server/V1/course/upload_topic_img/",onChange:function(){var d=(0,w.Z)(v().mark(function m(u){var f,a,g;return v().wrap(function(W){for(;;)switch(W.prev=W.next){case 0:if(console.log(u),f=M.state.topics,a=u.file,a.status!="removed"){W.next=8;break}return W.next=6,(0,e.EI)(a.name,"Topic");case 6:g=W.sent,console.log(g);case 8:f.map(function(B){return B.topic_id==p.topic_id&&(a.status=="removed"?B.topic_img="":(a&&a.status=="done"&&a.response&&(a.name=a.response.imgUrl),B.topic_img=a)),B}),M.setState({topics:f});case 10:case"end":return W.stop()}},m)}));return function(m){return d.apply(this,arguments)}}(),label:"Upload",max:1,value:p.topic_img?[p.topic_img]:[]})]}),(0,c.jsx)(U.Z,{title:"Are you sure to delete this topic? This action will also delets all courses attached to this topic",onConfirm:function(){return M.confirm(p.topic_id)},okText:"Yes",cancelText:"No",children:(0,c.jsx)("a",{children:(0,c.jsx)(I,{icon:n.Z,text:"delete"},"list-vertical-like-o")})})]}},extra:{dataIndex:"topic_img",render:function(h){if(h)return(0,c.jsx)("img",{width:"180px",alt:"logo",src:"".concat(h.url)})}},content:{dataIndex:"topic_content",render:function(h){return(0,c.jsx)("div",{children:h})}}}})})})})}}]),x}(A.Component)},11021:function(N,R,t){"use strict";t.d(R,{D0:function(){return Z},wA:function(){return Y},tu:function(){return b},rq:function(){return w},xH:function(){return L},G$:function(){return K},Sp:function(){return F},A:function(){return $},BK:function(){return V},BW:function(){return v},EI:function(){return A}});var P=t(3182),U=t(94043),_=t.n(U),D=t(21010),Z=function(){var l=(0,P.Z)(_().mark(function r(n){var i;return _().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return i="/server/V1/course/topicsByTeacher/?teacher_id=".concat(n),s.abrupt("return",(0,D.WY)(i));case 2:case"end":return s.stop()}},r)}));return function(n){return l.apply(this,arguments)}}(),Y=function(){var l=(0,P.Z)(_().mark(function r(n,i){var o;return _().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return o="/server/V1/course/edit/",e.abrupt("return",(0,D.WY)(o,{method:"post",data:{request_entity:"Topic",content:{topic_id:n,topic_info:i}}}));case 2:case"end":return e.stop()}},r)}));return function(n,i){return l.apply(this,arguments)}}(),b=function(){var l=(0,P.Z)(_().mark(function r(n,i,o,s,e){var j;return _().wrap(function(y){for(;;)switch(y.prev=y.next){case 0:return j="/server/V1/course/edit/",y.abrupt("return",(0,D.WY)(j,{method:"post",data:{request_entity:"Course",content:{id:n,related_topic:i,title:o,content:s,teacher_id:e}}}));case 2:case"end":return y.stop()}},r)}));return function(n,i,o,s,e){return l.apply(this,arguments)}}(),w=function(){var l=(0,P.Z)(_().mark(function r(n,i,o,s){var e;return _().wrap(function(T){for(;;)switch(T.prev=T.next){case 0:return e="/server/V1/course/create/",T.abrupt("return",(0,D.WY)(e,{method:"post",data:{request_entity:"Topic",content:{topic_title:n,topic_content:i,topic_img:o,teacher_id:s}}}));case 2:case"end":return T.stop()}},r)}));return function(n,i,o,s){return l.apply(this,arguments)}}(),L=function(){var l=(0,P.Z)(_().mark(function r(n,i,o,s){var e;return _().wrap(function(T){for(;;)switch(T.prev=T.next){case 0:return e="/server/V1/course/create/",T.abrupt("return",(0,D.WY)(e,{method:"post",data:{request_entity:"Course",content:{related_topic:n,title:i,content:o,teacher_id:s}}}));case 2:case"end":return T.stop()}},r)}));return function(n,i,o,s){return l.apply(this,arguments)}}(),K=function(){var l=(0,P.Z)(_().mark(function r(n){var i;return _().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return i="/server/V1/course/courses/".concat(n,"/"),s.abrupt("return",(0,D.WY)(i));case 2:case"end":return s.stop()}},r)}));return function(n){return l.apply(this,arguments)}}(),F=function(){var l=(0,P.Z)(_().mark(function r(n,i){var o;return _().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return o="/server/V1/course/courseDetail/".concat(n,"/").concat(i,"/"),e.abrupt("return",(0,D.WY)(o));case 2:case"end":return e.stop()}},r)}));return function(n,i){return l.apply(this,arguments)}}(),$=function(){var l=(0,P.Z)(_().mark(function r(n,i){var o;return _().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return o="/server/V1/course/delete/",e.abrupt("return",(0,D.WY)(o,{method:"post",data:{request_entity:"Course",related_topic:n,content:i}}));case 2:case"end":return e.stop()}},r)}));return function(n,i){return l.apply(this,arguments)}}(),V=function(){var l=(0,P.Z)(_().mark(function r(n){var i;return _().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return i="/server/V1/course/delete/",s.abrupt("return",(0,D.WY)(i,{method:"post",data:{request_entity:"Topic",content:n}}));case 2:case"end":return s.stop()}},r)}));return function(n){return l.apply(this,arguments)}}(),v=function(){var l=(0,P.Z)(_().mark(function r(n,i){var o;return _().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return o="/server/V1/course/sort/",e.abrupt("return",(0,D.WY)(o,{method:"post",data:{request_entity:"Course",related_topic:n,content:i}}));case 2:case"end":return e.stop()}},r)}));return function(n,i){return l.apply(this,arguments)}}(),A=function(){var l=(0,P.Z)(_().mark(function r(n,i){var o;return _().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return o="/server/V1/course/delete_img/",e.abrupt("return",(0,D.WY)(o,{method:"post",data:{request_entity:i,fname:n}}));case 2:case"end":return e.stop()}},r)}));return function(n,i){return l.apply(this,arguments)}}()}}]);
